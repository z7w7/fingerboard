import e,{useRef as t,useState as r,useEffect as a,useCallback as l,useMemo as s}from"react";import{times as n,uniqueId as c,isEmpty as f,isArray as o,minBy as m,maxBy as i}from"lodash";const d=[3,5,7,9,15,17],u=[12],_=n(6,Number),N=n(21,Number),h=n=>{const{data:h,className:p="",fretMark:v="default",fretWidth:z=72}=n,E=t(null),g=t([]),[k,b]=r([]);a((()=>{(()=>{if(f(h))return b([]),void E.current?.scrollTo(0,0);let e,t;o(h)?(b(h),e=m(h,"fret")?.fret||0,t=i(h,"fret")?.fret||0):(b([h]),e=h.fret,t=h.fret),e=Math.floor(e),t=Math.floor(t);const r=g.current[e].offsetLeft,a=g.current[t].offsetLeft,{offsetWidth:l=0,scrollLeft:s=0}=E.current||{},n=z+4;a>l+s-n&&E.current?.scrollTo(a-l+n,0),r<s&&E.current?.scrollTo(r,0)})()}),[h]);const y=e=>{const{offsetLeft:t,offsetWidth:r}=g.current[e];return`${t+r/2}px`},M=l((()=>{let e="z-fingerboard";return e+=v?" z-fingerboard--mark":"",e+=p?` ${p}`:"",e}),[v,p]);return e.createElement("div",{className:M(),ref:E},e.createElement("div",{className:"z-fingerboard__content"},s((()=>e.createElement(e.Fragment,null,e.createElement("div",{className:"z-frets"},N.map((t=>e.createElement("div",{key:c("fret_"),className:"z-frets__item",ref:e=>{e&&(g.current[t]=e)}},e.createElement("div",{className:`z-frets__item__block${d.includes(t)?" anchor-single":""}${u.includes(t)?" anchor-double":""}`,style:t?{width:`${z}px`}:{}}),"default"===v?(d.includes(t)||u.includes(t))&&e.createElement("div",{className:"z-frets__item__mark"},t):"all"===v?e.createElement("div",{className:"z-frets__item__mark"},t):null)))),e.createElement("div",{className:"z-strings"},_.map((()=>e.createElement("div",{key:c("string_"),className:"z-strings__item"})))))),[v,z]),k.map((t=>e.createElement("div",{key:c("point_"),className:"z-point",style:{left:y(Math.floor(t.fret)),top:20*Math.floor(t.string)+"%"}})))))};export{h as default};
